{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\scene/assets\\scripts\\scene\\LoadingScene.js"],"names":["SceneCom","require","GameRes","cc","Class","extends","properties","loadingBar","Node","appleNode","snakeNode","loadIndex","isLoading","isLoadFinish","progress","snakeRunDistance","comingLoadingRes","onLoad","width","start","GameSceneRes","loadRes","onDestroy","length","Game","SceneMgr","switchScene","SceneType","GameScene","temp","self","res","loader","err","texture","log","update","dt","getComponent","ProgressBar","x"],"mappings":";;;;;;AAAA,IAAIA,WAAWC,QAAQ,UAAR,CAAf;AACA,IAAIC,UAAUD,QAAQ,SAAR,CAAd;;AAEAE,GAAGC,KAAH,CAAS;AACLC,aAASL,QADJ;;AAGLM,gBAAY;AACTC,oBAAYJ,GAAGK,IADN;AAETC,mBAAWN,GAAGK,IAFL;AAGTE,mBAAWP,GAAGK;AAHL,KAHP;;AASL;AACAG,eAAW,IAVN;AAWLC,eAAW,IAXN;AAYLC,kBAAc,IAZT;;AAcLC,cAAU,IAdL;;AAgBLC,sBAAkB,IAhBb;;AAkBLC,sBAAkB,IAlBb;;AAoBLC,UApBK,oBAoBK;AACN,aAAKF,gBAAL,GAAwB,KAAKR,UAAL,CAAgBW,KAAhB,GAAwB,KAAKR,SAAL,CAAeQ,KAA/D;AACH,KAtBI;AAwBLC,SAxBK,mBAwBE;AACH,aAAKH,gBAAL,GAAwB,EAAxB;AACA;AACA;AACI;AACJ;AACI,aAAKA,gBAAL,GAAwBd,QAAQkB,YAAhC;AACJ;;AAEA,aAAKT,SAAL,GAAiB,CAAjB;AACA,aAAKC,SAAL,GAAiB,KAAjB;AACA,aAAKC,YAAL,GAAoB,KAApB;;AAEA,aAAKC,QAAL,GAAgB,CAAhB;;AAEA,aAAKO,OAAL;AACH,KAxCI;AA0CLC,aA1CK,uBA0CM;AACP,aAAKN,gBAAL,GAAwB,IAAxB;AACH,KA5CI;AA8CLK,WA9CK,qBA8CI;AACL,YAAG,KAAKV,SAAL,IAAkB,KAAKK,gBAAL,CAAsBO,MAA3C,EACA;AACI,iBAAKV,YAAL,GAAoB,IAApB;;AAEAW,iBAAKC,QAAL,CAAcC,WAAd,CAA0BF,KAAKG,SAAL,CAAeC,SAAzC;AACA;AACH;;AAED,YAAIC,OAAO,MAAM,KAAKb,gBAAL,CAAsBO,MAAvC;;AAEA,YAAIO,OAAO,IAAX;AACA,YAAIC,MAAM,KAAKf,gBAAL,CAAsB,KAAKL,SAA3B,CAAV;AACAmB,aAAKlB,SAAL,GAAiB,IAAjB;AACA;AACAT,WAAG6B,MAAH,CAAUX,OAAV,CAAkBU,GAAlB,EAAuB,UAAUE,GAAV,EAAeC,OAAf,EAAwB;AAC3C,gBAAGD,GAAH,EAAO;AACH9B,mBAAGgC,GAAH,CAAOF,GAAP;AACH,aAFD,MAEK;AACDH,qBAAKhB,QAAL,IAAiBe,IAAjB;AACAC,qBAAKlB,SAAL,GAAiB,KAAjB;AACH;AACJ,SAPD;AAQA,aAAKD,SAAL;AACH,KAtEI;AAwELyB,UAxEK,kBAwEEC,EAxEF,EAwEK;;AAEN;AACA,YAAG,CAAC,KAAKxB,YAAT,EAAsB;AAClB,gBAAG,CAAC,KAAKD,SAAT,EAAmB;AACf,qBAAKS,OAAL;AACH;;AAED,gBAAG,KAAKd,UAAR,EAAmB;AACf,qBAAKA,UAAL,CAAgB+B,YAAhB,CAA6BnC,GAAGoC,WAAhC,EAA6CzB,QAA7C,GAAwD,KAAKA,QAAL,GAAgB,GAAxE;AACH;;AAED,gBAAG,KAAKJ,SAAR,EAAkB;AACd,qBAAKA,SAAL,CAAe8B,CAAf,GAAmB,KAAK1B,QAAL,IAAiB,KAAKC,gBAAL,GAAwB,GAAzC,CAAnB;AACH;AACJ;AACJ;AAxFI,CAAT","file":"LoadingScene.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\scene","sourcesContent":["var SceneCom = require(\"SceneCom\");\r\nvar GameRes = require(\"GameRes\");\r\n\r\ncc.Class({\r\n    extends: SceneCom,\r\n\r\n    properties: {\r\n       loadingBar: cc.Node,\r\n       appleNode: cc.Node,\r\n       snakeNode: cc.Node,\r\n    },\r\n\r\n    //加载资源\r\n    loadIndex: null,\r\n    isLoading: null,\r\n    isLoadFinish: null,\r\n\r\n    progress: null,\r\n\r\n    snakeRunDistance: null,\r\n\r\n    comingLoadingRes: null,\r\n\r\n    onLoad () {\r\n        this.snakeRunDistance = this.loadingBar.width - this.snakeNode.width;\r\n    },\r\n\r\n    start(){\r\n        this.comingLoadingRes = [];\r\n        //设置即将加载的资源\r\n        // if(Game.SceneMgr.getCurSceneType() == null){\r\n            // this.comingLoadingRes = GameRes.StartSceneRes;\r\n        // }else if(Game.SceneMgr.getCurSceneType() == Game.SceneType.SelectScene){\r\n            this.comingLoadingRes = GameRes.GameSceneRes;\r\n        // }\r\n\r\n        this.loadIndex = 0;\r\n        this.isLoading = false;\r\n        this.isLoadFinish = false;\r\n\r\n        this.progress = 0;\r\n\r\n        this.loadRes();\r\n    },\r\n\r\n    onDestroy(){\r\n        this.comingLoadingRes = null;\r\n    },\r\n\r\n    loadRes(){\r\n        if(this.loadIndex >= this.comingLoadingRes.length)\r\n        {\r\n            this.isLoadFinish = true;\r\n\r\n            Game.SceneMgr.switchScene(Game.SceneType.GameScene);\r\n            return;\r\n        }\r\n\r\n        var temp = 100 / this.comingLoadingRes.length;\r\n        \r\n        var self = this;\r\n        var res = this.comingLoadingRes[this.loadIndex];\r\n        self.isLoading = true;\r\n        // 加载 Texture，不需要后缀名\r\n        cc.loader.loadRes(res, function (err, texture) {\r\n            if(err){\r\n                cc.log(err);\r\n            }else{\r\n                self.progress += temp;\r\n                self.isLoading = false;\r\n            }\r\n        });\r\n        this.loadIndex ++;\r\n    },\r\n\r\n    update(dt){\r\n\r\n        //加载资源\r\n        if(!this.isLoadFinish){\r\n            if(!this.isLoading){\r\n                this.loadRes();\r\n            }\r\n\r\n            if(this.loadingBar){\r\n                this.loadingBar.getComponent(cc.ProgressBar).progress = this.progress / 100;\r\n            }\r\n    \r\n            if(this.snakeNode){\r\n                this.snakeNode.x = this.progress * (this.snakeRunDistance / 100) ;\r\n            }\r\n        }\r\n    }\r\n\r\n});\r\n"]}