{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\network/assets\\scripts\\network\\NetManager.js"],"names":["window","Game","NetManager","m_xhr","connectP","addr","port","onOpen","event","getXMLHttpRequest","XMLHttpRequest","ActiveXObject","onMessage","self","readyState","status","rawData","JSON","parse","responseText","onError","e","err","cc","Log","sendMsg","type","url","requestData","successCb","wx","undefined","request","data","success","res","my_data","errno","console","log","errmsg"],"mappings":";;;;;;AAAAA,OAAOC,IAAP,GAAcD,OAAOC,IAAP,IAAe,EAA7B;AACA;;;;AAIAD,OAAOC,IAAP,CAAYC,UAAZ,GAAyB;;AAErBC,WAAO,IAFc;;AAIrBC,cAAU,kBAAUC,IAAV,EAAgBC,IAAhB,EAAsB,CAC/B,CALoB;;AAOrBC,YAAQ,gBAAUC,KAAV,EAAiB,CACxB,CARoB;;AAUrB;;;AAGAC,uBAAmB,6BAAY;AAC3B,eAAOC,iBAAiB,IAAIA,cAAJ,EAAjB,GAAwC,IAAIC,aAAJ,CAAkB,gBAAlB,CAA/C;AACH,KAfoB;;AAiBrB;;;AAGAC,eAAW,qBAAY;AACnB,YAAIC,OAAO,IAAX;;AAEA,YAAIV,QAAQU,KAAKV,KAAjB;;AAEA,YAAI;AACA,gBAAGA,MAAMW,UAAN,IAAoB,CAAvB,EAA0B;AACtB,oBAAGX,MAAMY,MAAN,IAAgB,GAAnB,EAAwB;AACpB,wBAAIC,UAAUC,KAAKC,KAAL,CAAWf,MAAMgB,YAAjB,CAAd;AACH,iBAFD,MAEO;AACHN,yBAAKO,OAAL,CAAa,gCAAgCjB,MAAMY,MAAnD;AACH;AACJ;AACJ,SARD,CAQC,OAAOM,CAAP,EAAS,CACT;AACJ,KAnCoB;;AAqCrB;;;AAGDD,aAAS,iBAAUE,GAAV,EAAe;AACnBC,WAAGC,GAAH,CAAOF,GAAP;AACH,KA1CoB;;AA4CrB;;;;;;AAMAG,aAAS,iBAAUC,IAAV,EAAgBC,GAAhB,EAAqBC,WAArB,EAAkCC,SAAlC,EAA6C;;AAElD,YAAG7B,OAAO8B,EAAP,IAAaC,SAAhB,EAA0B;AACtB;AACH;;AAED,YAAIlB,OAAO,IAAX;;AAEAiB,WAAGE,OAAH,CAAW;AACPL,iBAAKA,GADE;AAEPM,kBAAML,WAFC;AAGPM,qBAAS,iBAAUC,GAAV,EAAe;AACpB,oBAAIC,UAAUD,IAAIF,IAAlB;;AAEA,oBAAIG,QAAQC,KAAR,IAAiB,CAArB,EAAwB;AAAC;AACrBR,8BAAUO,OAAV;AACH,iBAFD,MAEO;AACHE,4BAAQC,GAAR,CAAY,aAAZ,EAA2BH,QAAQI,MAAnC;AACAX,8BAAUO,OAAV;AACH;;AAEDE,wBAAQC,GAAR,CAAY,SAAZ,EAAuBH,OAAvB;AACH;AAdM,SAAX;AAgBH;AA1EoB,CAAzB","file":"NetManager.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\network","sourcesContent":["window.Game = window.Game || {};\r\n/**\r\n* 消息管理器，负责跟服务器收发消息包\r\n* @class\r\n*/\r\nwindow.Game.NetManager = {\r\n\r\n    m_xhr: null,\r\n\r\n    connectP: function (addr, port) {\r\n    },\r\n\r\n    onOpen: function (event) {\r\n    },\r\n\r\n    /**\r\n     * 获取HttpRequest对象\r\n     */\r\n    getXMLHttpRequest: function () {\r\n        return XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject(\"MSXML2.XMLHTTP\");\r\n    },\r\n\r\n    /**\r\n     * 发送消息回调函数\r\n     */\r\n    onMessage: function () {\r\n        var self = this;\r\n\r\n        var m_xhr = self.m_xhr;\r\n\r\n        try {\r\n            if(m_xhr.readyState == 4) {\r\n                if(m_xhr.status == 200) {\r\n                    var rawData = JSON.parse(m_xhr.responseText);\r\n                } else {\r\n                    self.onError(\"Net Status Error, Status = \" + m_xhr.status);\r\n                }\r\n            }\r\n        }catch (e){\r\n        }\r\n    },\r\n\r\n    /*\r\n    *   网络错误\r\n    */\r\n   onError: function (err) {\r\n        cc.Log(err);\r\n    },\r\n\r\n    /**\r\n     * 发送消息到服务器\r\n     * @param msgType   [大消息Id]\r\n     * @param msgId     [小消息Id]\r\n     * @param data      [消息体]\r\n     */\r\n    sendMsg: function (type, url, requestData, successCb) {\r\n\r\n        if(window.wx == undefined){\r\n            return;\r\n        }\r\n\r\n        var self = this;\r\n\r\n        wx.request({\r\n            url: url,\r\n            data: requestData,\r\n            success: function (res) {\r\n                var my_data = res.data;\r\n\r\n                if (my_data.errno == 0) {//返回结果正确\r\n                    successCb(my_data);\r\n                } else {\r\n                    console.log(\"服务器错误，请重新尝试\", my_data.errmsg);\r\n                    successCb(my_data);\r\n                }\r\n\r\n                console.log(\"服务器相应数据\", my_data);\r\n            },\r\n        });\r\n    }\r\n};\r\n"]}