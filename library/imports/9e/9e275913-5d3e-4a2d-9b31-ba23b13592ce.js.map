{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\SnakeTail.js"],"names":["SnakeNode","require","SnakeDirection","cc","Class","extends","previouNode","newSprite","ctor","setName","sprite","spriteFrame","setTexture","url","raw","move","direction","doRotateAction","doMoveAction","moveFinish","getNewSprite","active","doTransfrom","newPos","Game","MapUtil","ConvertGIDToPos","nextGID","isChanged","x","director","getWinSize","width","parent","convertToNodeSpaceAR","position","zIndex","rotation","node","Node","addComponent","Sprite","SpriteFrame","addChild","changeParent","_super","upGID","GetUpGID","downGID","GetDownGID","leftGID","GetLeftGID","rifhtGID","GetRightGID","tempGID","snakes","bodyNode","getLastSection","getNextGID"],"mappings":"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","file":"SnakeTail.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["var SnakeNode = require(\"SnakeNode\");\r\nvar SnakeDirection = require('ConstDefine').SnakeDirection;\r\n\r\ncc.Class({\r\n    extends: SnakeNode,\r\n\r\n    previouNode: null,\r\n\r\n    newSprite: null,\r\n\r\n    ctor(){\r\n        this.setName(\"SnakeTail\");\r\n        this.sprite.spriteFrame.setTexture(cc.url.raw('resources/gamescene/tail.png'));\r\n    },\r\n\r\n    move(direction){\r\n        this.doRotateAction(direction);\r\n        this.doMoveAction();\r\n    },\r\n\r\n    moveFinish(){\r\n        this.doRotateAction();\r\n        var newSprite = this.getNewSprite();\r\n        if(newSprite){\r\n            newSprite.active = false;\r\n        }\r\n    },\r\n\r\n    doTransfrom(){\r\n        var newSprite = this.getNewSprite();\r\n        if(newSprite){\r\n            var newPos = Game.MapUtil.ConvertGIDToPos(this.nextGID);\r\n            if(this.isChanged){\r\n                newPos.x += (cc.director.getWinSize().width - 1334) * 0.5;\r\n                newPos = this.parent.convertToNodeSpaceAR(newPos);\r\n            }\r\n            newSprite.position = newPos;\r\n            newSprite.zIndex = this.zIndex - 1;\r\n            newSprite.active = true;\r\n            newSprite.rotation = this.rotation;\r\n        }\r\n    },\r\n\r\n    getNewSprite(){\r\n        if(!this.newSprite){\r\n            var node = new cc.Node(\"Tail_NewSprite\");\r\n            var sprite = node.addComponent(cc.Sprite);\r\n            sprite.spriteFrame = new cc.SpriteFrame();\r\n            sprite.spriteFrame.setTexture(cc.url.raw(\"resources/gamescene/tail.png\"));\r\n            this.parent.addChild(node);\r\n\r\n            this.newSprite = node;\r\n        }\r\n        return this.newSprite;\r\n    },\r\n\r\n    changeParent(parent){\r\n        this._super(parent);\r\n\r\n        var newSprite = this.getNewSprite();       \r\n\r\n        newSprite.parent = parent;\r\n    },\r\n\r\n    doRotateAction(){\r\n        var upGID = Game.MapUtil.GetUpGID(this.nextGID);\r\n        var downGID = Game.MapUtil.GetDownGID(this.nextGID);\r\n        var leftGID = Game.MapUtil.GetLeftGID(this.nextGID);\r\n        var rifhtGID = Game.MapUtil.GetRightGID(this.nextGID);\r\n        var tempGID = this.snakes.bodyNode.getLastSection().getNextGID();\r\n        \r\n        if(upGID == tempGID){\r\n            this.rotation = -90;\r\n        }else if(downGID == tempGID){\r\n            this.rotation = 90;\r\n        }else if(leftGID == tempGID){\r\n            this.rotation = -180;\r\n        }\r\n        else if(rifhtGID == tempGID){\r\n            this.rotation = 0;\r\n        }\r\n    },\r\n});"]}