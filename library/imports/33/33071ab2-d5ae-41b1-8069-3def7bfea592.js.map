{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Snakes.js"],"names":["MoveDirection","require","SnakeHead","SnakeBody","SnakeTail","Util","BaseNode","cc","Class","extends","headNode","bodyNode","tailNode","isWin","dropComponent","winDirection","ctor","setAnchorPoint","p","setPosition","doEnter","addComponent","doExit","removeAllChildren","setMyChangedDirtyFlag","dirtyFlag","_super","create","parentNode","startGID","Game","MapUtil","GetStartGID","headGID","tailGID","addSection","bodyGID","addChild","setSnake","doRotateAction","zIndex","isStatic","droping","getHeadCurGID","getGID","move","refreshZIndex","getAllNode","arr","push","concat","getAllSection","getAllGID","gidarr","i","bodyLength","getSectionGID","getMaxGID","maxY","length","gid","tid","ConvertGIDToTID","y","maxGID","getNodeByGID","getSectionByGID","getAllNextGID","getNextGID","getSectionNextGID","eatApple","direction","appleGID","doMeetFace","setNextGID","setDirection","EventCenter","DispatchEvent","MessageType","Update_Game_Object_ZIndex","changeParent","parent","allNode","node","isVertical","allGID","curGID","totalLen","nextGID","GetDownGID","IsContainElement","doDropAction","GlobalVar","isDroping","moveFinish","myDropDirtyFlag","DispatchEventSync","Snake_Move_Finish","Check_Stone_Drop","CheckIsNotMove","dropFinish","GAME_FAIL","Snake_Drop_Finish","outLevel","doNormalFace","doAtTheMouthFace","doDespairFace","gameOver","win","failed","frameOnMove","dt","onDestroy","log"],"mappings":"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","file":"Snakes.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["var MoveDirection   = require('ConstDefine').MoveDirection;\r\nvar SnakeHead       = require('SnakeHead');\r\nvar SnakeBody       = require('SnakeBody');\r\nvar SnakeTail       = require('SnakeTail');\r\nvar Util            = require('Util');\r\nvar BaseNode        = require(\"BaseNode\");\r\n\r\ncc.Class({\r\n    extends: BaseNode,\r\n\r\n    headNode: null,\r\n    bodyNode: null,\r\n    tailNode: null,\r\n    isWin   : null,\r\n    dropComponent: null,\r\n    winDirection: null,\r\n\r\n    ctor(){\r\n        this.setAnchorPoint(cc.p(0, 0));\r\n        this.setPosition(-667, -375);\r\n        this.doEnter();\r\n    },\r\n\r\n    doEnter(){\r\n        this.isWin = false;\r\n        this.winDirection = 0;\r\n        this.dropComponent = this.addComponent(\"DropComponent\");\r\n    },\r\n\r\n    doExit(){\r\n        this.removeAllChildren();\r\n\r\n        this.headNode.doExit();\r\n        this.bodyNode.doExit();\r\n        this.tailNode.doExit();\r\n\r\n        this.dropComponent = null;\r\n        this.headNode = null;\r\n        this.bodyNode = null;\r\n        this.tailNode = null;\r\n    },\r\n\r\n    setMyChangedDirtyFlag(dirtyFlag){\r\n        this._super(dirtyFlag);\r\n\r\n        this.headNode.setMyChangedDirtyFlag(dirtyFlag);\r\n        this.bodyNode.setMyChangedDirtyFlag(dirtyFlag);\r\n        this.tailNode.setMyChangedDirtyFlag(dirtyFlag);\r\n    },\r\n\r\n    create() {\r\n        var parentNode = this;\r\n\r\n        if(parentNode){\r\n            var startGID = Game.MapUtil.GetStartGID();\r\n\r\n            this.headNode = new SnakeHead(startGID.headGID);\r\n            this.bodyNode = new SnakeBody(parentNode);\r\n            this.tailNode = new SnakeTail(startGID.tailGID);\r\n            this.bodyNode.addSection(startGID.bodyGID);\r\n\r\n            parentNode.addChild(this.headNode, 10);\r\n            parentNode.addChild(this.tailNode, 9);\r\n\r\n            this.headNode.setSnake(this);\r\n            this.bodyNode.setSnake(this);\r\n            this.tailNode.setSnake(this);\r\n\r\n            this.tailNode.doRotateAction();\r\n\r\n            parentNode.zIndex = 10;\r\n        }\r\n    },\r\n\r\n    isStatic(){\r\n        if(this.dropComponent){\r\n            if(this.dropComponent.droping){\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    getHeadCurGID(){\r\n        return this.headNode.getGID();\r\n    },\r\n\r\n    move(){\r\n        this.tailNode.move();\r\n        this.bodyNode.move();\r\n        this.headNode.move();\r\n    },\r\n\r\n    refreshZIndex(){\r\n        return;\r\n\r\n        // var zIndexArr = [];\r\n\r\n        // zIndexArr.push(this.tailNode.zIndex);\r\n        // var allSection = this.bodyNode.getAllSection();\r\n        // for(var i = 0;i < allSection.length; i ++){\r\n        //     zIndexArr.push(allSection[i].zIndex);\r\n        // }\r\n        // zIndexArr.push(this.headNode.zIndex);\r\n\r\n        // Util.Sort(zIndexArr);\r\n        \r\n        // var index = 0;\r\n\r\n        // this.headNode.zIndex = zIndexArr[index ++];\r\n        // for(var i = allSection.length - 1; i >= 0; i --){\r\n        //     allSection[i].zIndex = zIndexArr[index ++];\r\n        // }\r\n        // this.tailNode.zIndex = zIndexArr[index++];\r\n\r\n        // var a = this.headNode.zIndex;\r\n        // this.headNode.zIndex = this.tailNode.zIndex;\r\n        // this.tailNode.zIndex = a;\r\n    },\r\n\r\n    getAllNode: function(){\r\n        var arr = [];\r\n\r\n        if(this.tailNode){\r\n            arr.push(this.tailNode);\r\n        }\r\n\r\n        arr = arr.concat(this.bodyNode.getAllSection());\r\n\r\n        if(this.headNode){\r\n            arr.push(this.headNode);\r\n        }\r\n\r\n        return arr;\r\n    },\r\n\r\n    getAllGID: function(){\r\n        var gidarr = [];\r\n\r\n        if(this.headNode){\r\n            gidarr.push(this.headNode.getGID());\r\n        }\r\n        if(this.tailNode){\r\n            gidarr.push(this.tailNode.getGID());\r\n        }\r\n\r\n        if(this.bodyNode){\r\n            for(var i = 0;i < this.bodyNode.bodyLength;i ++){\r\n                var bodyGID = this.bodyNode.getSectionGID(i);\r\n                gidarr.push(bodyGID);\r\n            }\r\n        }\r\n        return gidarr;\r\n    },\r\n\r\n    getMaxGID: function(){\r\n        var gidarr = this.getAllGID();\r\n        var maxY = 0;\r\n        for(var i = 0;i < gidarr.length;i++){\r\n            var gid = gidarr[i];\r\n            var tid = Game.MapUtil.ConvertGIDToTID(gid);\r\n            if(tid.y > maxY){\r\n                maxY = tid.y;\r\n            }\r\n        }\r\n\r\n        var maxGID = [];\r\n        for(var i = 0;i < gidarr.length;i++){\r\n            var gid = gidarr[i];\r\n            var tid = Game.MapUtil.ConvertGIDToTID(gid);\r\n            if(tid.y == maxY){\r\n                maxGID.push(gid);\r\n            }\r\n        }\r\n        return maxGID;\r\n    },\r\n\r\n    getNodeByGID: function(gid){\r\n        if(gid == this.headNode.gid){\r\n            return this.headNode;\r\n        }\r\n        if(gid == this.tailNode.gid){\r\n            return this.tailNode;\r\n        }\r\n\r\n        return this.bodyNode.getSectionByGID(gid);\r\n    },\r\n\r\n    getAllNextGID: function(){\r\n        var gidarr = [];\r\n        gidarr.push(this.headNode.getNextGID());\r\n        gidarr.push(this.tailNode.getNextGID());\r\n\r\n        for(var i = 0;i < this.bodyNode.bodyLength;i ++){\r\n            var bodyGID = this.bodyNode.getSectionNextGID(i);\r\n            gidarr.push(bodyGID);\r\n        }\r\n        return gidarr;\r\n    },\r\n\r\n    eatApple(direction, appleGID){\r\n        this.doMeetFace();\r\n        \r\n        this.bodyNode.addSection(this.headNode.getGID());\r\n        this.bodyNode.setSnake(this);\r\n        this.headNode.setNextGID(appleGID);\r\n        // this.headNode.move(direction);\r\n\r\n        this.headNode.setDirection(direction);\r\n        // this.headNode.doTransfrom();\r\n\r\n        Game.EventCenter.DispatchEvent(Game.MessageType.Update_Game_Object_ZIndex);\r\n\r\n        this.setMyChangedDirtyFlag(true);\r\n    },\r\n\r\n    changeParent(parent){\r\n        if(parent){\r\n            var allNode = this.getAllNode();\r\n\r\n            for(var i = 0;i < allNode.length;i ++){\r\n                var node = allNode[i];\r\n                node.changeParent(parent);\r\n            }\r\n        }\r\n    },\r\n\r\n    //是否与地面垂直\r\n    isVertical(){\r\n        var allGID = this.getAllGID();\r\n\r\n        var curGID = this.headNode.getGID();\r\n        var totalLen = this.bodyNode.bodyLength + 2;\r\n\r\n        for(var i = 0;i < totalLen - 1;i ++){\r\n            var nextGID = Game.MapUtil.GetDownGID(curGID);\r\n            if(Util.IsContainElement(allGID, nextGID)){\r\n                curGID = nextGID;\r\n            }else{\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    },\r\n\r\n    doDropAction(){\r\n        Game.GlobalVar.isDroping = true;\r\n\r\n        this.headNode.doDropAction();\r\n        this.bodyNode.doDropAction();\r\n        this.tailNode.doDropAction();\r\n    },\r\n    \r\n    moveFinish(){\r\n        this.myDropDirtyFlag = true;\r\n\r\n        Game.EventCenter.DispatchEventSync(Game.MessageType.Snake_Move_Finish);\r\n        Game.EventCenter.DispatchEventSync(Game.MessageType.Check_Stone_Drop);\r\n        Game.EventCenter.DispatchEventSync(Game.MessageType.CheckIsNotMove);\r\n    },\r\n\r\n    dropFinish(){\r\n        Game.GlobalVar.isDroping = false;\r\n\r\n        if(this.headNode.y < 0){\r\n            Game.EventCenter.DispatchEvent(Game.MessageType.GAME_FAIL);\r\n            return;\r\n        }\r\n        \r\n        this.dropComponent.dropFinish();\r\n        this.myDropDirtyFlag = true;\r\n\r\n        Game.EventCenter.DispatchEventSync(Game.MessageType.Snake_Drop_Finish);\r\n        Game.EventCenter.DispatchEventSync(Game.MessageType.Check_Stone_Drop);\r\n    },\r\n\r\n    outLevel(direction){\r\n        // this.headNode.setDirection(direction);\r\n        // this.bodyNode.setDirection(direction);\r\n        // this.tailNode.setDirection(direction);\r\n    },\r\n\r\n    //正常表情\r\n    doNormalFace(){\r\n        this.headNode.doNormalFace();\r\n    },\r\n\r\n    //流口水表情\r\n    doAtTheMouthFace(){\r\n        this.headNode.doAtTheMouthFace();\r\n    },\r\n\r\n    //满足表情\r\n    doMeetFace(){\r\n        this.headNode.doMeetFace();\r\n    },\r\n\r\n    //绝望表情\r\n    doDespairFace(){\r\n        this.headNode.doDespairFace();\r\n    },\r\n\r\n    gameOver(){\r\n        // if(this.headNode){\r\n        //     this.headNode.gameOver();\r\n        //     this.headNode = null;\r\n        // }\r\n        // if(this.bodyNode){\r\n        //     this.bodyNode.gameOver();\r\n        //     this.bodyNode = null;\r\n        // }\r\n        // if(this.tailNode){\r\n        //     this.tailNode.gameOver();\r\n        //     this.tailNode = null;\r\n        // }\r\n\r\n        // if(this.dropComponent){\r\n        //     this.dropComponent.gameOver();\r\n        //     this.dropComponent = null;\r\n        // }\r\n\r\n        // this.headNode = null;\r\n        // this.bodyNode = null;\r\n        // this.tailNode = null;\r\n        // this.dropComponent = null;\r\n\r\n        // this.node.destroy();\r\n    },  \r\n\r\n    win(){\r\n        // this.node.destroy();\r\n    },\r\n\r\n    failed(){\r\n        // this.node.destroy();\r\n    },\r\n\r\n    frameOnMove (dt) {\r\n        if(this.headNode)\r\n            this.headNode.frameOnMove(dt);\r\n        if(this.bodyNode)\r\n            this.bodyNode.frameOnMove(dt);\r\n        if(this.tailNode)\r\n            this.tailNode.frameOnMove(dt);\r\n        if(this.dropComponent)\r\n            this.dropComponent.frameOnMove(dt);\r\n    },\r\n\r\n    onDestroy(){\r\n        cc.log(\"Snakes-->onDestroy\");\r\n    }\r\n});\r\n\r\n"]}