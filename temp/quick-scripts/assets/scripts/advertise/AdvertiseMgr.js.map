{"version":3,"sources":["AdvertiseMgr.js"],"names":["WXHelper","require","module","exports","bannerAd","CreateBannerAd","config","IsWXContext","cc","log","modelWidth","Game","SystemInfo","windowWidth","modelHeight","windowHeight","wx","createBannerAd","adUnitId","adUnitID","style","left","top","width","show","self","onResize","buttonTop","buttonLeft","realWidth","undefined","realHeight","console","res","height","DestroyBannerAd","hide","destroy","CreateVideoAd","callback","videoAd","createRewardedVideoAd","load","then","catch","err","errMsg","onClose","isFinish","isEnded"],"mappings":";;;;;;AAAA,IAAIA,WAAWC,QAAQ,UAAR,CAAf;;AAEAC,OAAOC,OAAP,GAAiB;;AAEbC,cAAU,IAFG;;AAIbC,oBAAgB,wBAASC,MAAT,EAAgB;AAC5B,YAAGN,SAASO,WAAT,MAA0B,KAA7B,EAAmC;AAC/B;AACH;;AAED,YAAG,CAACD,MAAJ,EAAW;AACP;AACH;;AAEDE,WAAGC,GAAH,CAAO,oDAAP;;AAEA,YAAIC,aAAaC,KAAKC,UAAL,CAAgBC,WAAjC;AACA,YAAIC,cAAcH,KAAKC,UAAL,CAAgBG,YAAlC;;AAGA,YAAIX,WAAWY,GAAGC,cAAH,CAAkB;AAC7BC,sBAAUZ,OAAOa,QADY;AAE7BC,mBAAO;AACHC,sBAAM,CADH;AAEHC,qBAAK,CAFF;AAGHC,uBAAOjB,OAAOkB,IAAP,CAAYD;AAHhB;AAFsB,SAAlB,CAAf;;AASA,YAAIE,OAAO,IAAX;;AAEArB,iBAASsB,QAAT,CAAkB,eAAO;AACrB,gBAAIC,YAAYrB,OAAOkB,IAAP,CAAYF,GAA5B;AACA,gBAAIM,aAAalB,aAAa,CAAb,GAAiBN,SAASgB,KAAT,CAAeS,SAAf,GAA2B,GAA7D;;AAEA,gBAAGvB,OAAOkB,IAAP,CAAYF,GAAZ,IAAmBQ,SAAtB,EAAgC;AAC5BH,4BAAYb,cAAcV,SAASgB,KAAT,CAAeW,UAAzC;AACH;AACD3B,qBAASgB,KAAT,CAAeC,IAAf,GAAsBO,UAAtB;AACAxB,qBAASgB,KAAT,CAAeE,GAAf,GAAqBK,SAArB;;AAEAK,oBAAQvB,GAAR,CAAYmB,UAAZ;AACAI,oBAAQvB,GAAR,CAAYkB,SAAZ;;AAEAK,oBAAQvB,GAAR,CAAYwB,IAAIV,KAAhB,EAAuBU,IAAIC,MAA3B;AACAF,oBAAQvB,GAAR,CAAYL,SAASgB,KAAT,CAAeS,SAA3B,EAAsCzB,SAASgB,KAAT,CAAeW,UAArD;AAEH,SAhBD;AAiBA3B,iBAASoB,IAAT;;AAEA,aAAKpB,QAAL,GAAgBA,QAAhB;AACH,KAlDY;;AAoDb+B,qBAAiB,2BAAU;AACvB,YAAG,KAAK/B,QAAR,EAAiB;AACb,iBAAKA,QAAL,CAAcgC,IAAd;AACA,iBAAKhC,QAAL,CAAciC,OAAd;AACH;AACJ,KAzDY;;AA2DbC,mBAAe,uBAAShC,MAAT,EAAiBiC,QAAjB,EAA0B;AACrC,YAAGvC,SAASO,WAAT,MAA0B,KAA7B,EAAmC;AAC/B;AACH;;AAED,YAAG,CAACD,MAAJ,EAAW;AACP;AACH;;AAED,YAAIkC,UAAUxB,GAAGyB,qBAAH,CAAyB;AACnCvB,sBAAUZ,OAAOa;AADkB,SAAzB,CAAd;;AAIAqB,gBAAQE,IAAR,GAAeC,IAAf,CAAoB;AAAA,mBAAMH,QAAQhB,IAAR,EAAN;AAAA,SAApB,EAA0CoB,KAA1C,CAAgD;AAAA,mBAAOZ,QAAQvB,GAAR,CAAYoC,IAAIC,MAAhB,CAAP;AAAA,SAAhD;;AAEAN,gBAAQO,OAAR,CAAgB,eAAO;AACnBvC,eAAGC,GAAH,CAAOwB,GAAP;AACA;AACA;AACA,gBAAIe,WAAW,KAAf;;AAEA,gBAAIf,OAAOA,IAAIgB,OAAX,IAAsBhB,QAAQH,SAAlC,EAA6C;AAC3C;AACEkB,2BAAW,IAAX;AACH,aAHD,MAIK;AACD;AACAA,2BAAW,KAAX;AACH;;AAEDT,qBAASS,QAAT;AACH,SAhBD;AAiBH;AA3FY,CAAjB","file":"AdvertiseMgr.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\advertise","sourcesContent":["var WXHelper = require(\"WXHelper\");\r\n\r\nmodule.exports = {\r\n\r\n    bannerAd: null,\r\n\r\n    CreateBannerAd: function(config){\r\n        if(WXHelper.IsWXContext() == false){\r\n            return;\r\n        }\r\n\r\n        if(!config){\r\n            return;\r\n        }\r\n\r\n        cc.log(\"CreateBannerAd------------------------------------\");\r\n\r\n        let modelWidth = Game.SystemInfo.windowWidth;\r\n        let modelHeight = Game.SystemInfo.windowHeight;\r\n\r\n\r\n        let bannerAd = wx.createBannerAd({\r\n            adUnitId: config.adUnitID,\r\n            style: {\r\n                left: 0,\r\n                top: 0,\r\n                width: config.show.width,\r\n            }\r\n        });\r\n\r\n        var self = this;\r\n\r\n        bannerAd.onResize(res => {\r\n            let buttonTop = config.show.top;\r\n            let buttonLeft = modelWidth / 2 - bannerAd.style.realWidth * 0.5;\r\n\r\n            if(config.show.top == undefined){\r\n                buttonTop = modelHeight - bannerAd.style.realHeight;\r\n            }\r\n            bannerAd.style.left = buttonLeft;\r\n            bannerAd.style.top = buttonTop;\r\n\r\n            console.log(buttonLeft)\r\n            console.log(buttonTop)\r\n\r\n            console.log(res.width, res.height)\r\n            console.log(bannerAd.style.realWidth, bannerAd.style.realHeight)\r\n\r\n        });\r\n        bannerAd.show();\r\n\r\n        this.bannerAd = bannerAd;\r\n    },\r\n\r\n    DestroyBannerAd: function(){\r\n        if(this.bannerAd){\r\n            this.bannerAd.hide();\r\n            this.bannerAd.destroy();\r\n        }\r\n    },\r\n\r\n    CreateVideoAd: function(config, callback){\r\n        if(WXHelper.IsWXContext() == false){\r\n            return;\r\n        }\r\n\r\n        if(!config){\r\n            return;\r\n        }\r\n\r\n        let videoAd = wx.createRewardedVideoAd({\r\n            adUnitId: config.adUnitID,\r\n        });\r\n        \r\n        videoAd.load().then(() => videoAd.show()).catch(err => console.log(err.errMsg));\r\n\r\n        videoAd.onClose(res => {\r\n            cc.log(res);\r\n            // 用户点击了【关闭广告】按钮\r\n            // 小于 2.1.0 的基础库版本，res 是一个 undefined\r\n            var isFinish = false;\r\n\r\n            if (res && res.isEnded || res === undefined) {\r\n              // 正常播放结束，可以下发游戏奖励\r\n                isFinish = true;\r\n            }\r\n            else {\r\n                // 播放中途退出，不下发游戏奖励\r\n                isFinish = false;\r\n            }\r\n\r\n            callback(isFinish);\r\n        })\r\n    }\r\n};"]}