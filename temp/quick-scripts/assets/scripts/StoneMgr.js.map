{"version":3,"sources":["StoneMgr.js"],"names":["StoneNode","require","cc","Class","extends","Component","stoneNodeVec","ctor","GenerateStone","parent","self","parentNode","allStoneGID","Game","MapUtil","GetAllStoneGID","i","length","stoneNode","addChild","push","GetAllStoneNode","stone","gid","RemoveStoneByGID","destroy","splice","Clear","doExit","EventCenter","RemoveEvent","uuid","SetMyDropDirtyFlag","setMyDropDirtyFlag","FrameOnMove","dt","myDeleteDirtyFlag","frameOnMove","onDestroy","log"],"mappings":"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","file":"StoneMgr.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["var StoneNode = require('./gameobject/StoneNode');\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    stoneNodeVec: null,\r\n\r\n    ctor(){\r\n\r\n    },\r\n\r\n    GenerateStone(parent) {\r\n        var self = this;\r\n        var parentNode = parent;\r\n\r\n        if(parentNode){\r\n            this.stoneNodeVec = [];\r\n\r\n            var allStoneGID = Game.MapUtil.GetAllStoneGID();\r\n            for(var i = 0;i < allStoneGID.length;i ++){\r\n                var stoneNode = new StoneNode(allStoneGID[i]);\r\n                parentNode.addChild(stoneNode, 10);\r\n\r\n                this.stoneNodeVec.push(stoneNode);\r\n            }\r\n        }\r\n    },\r\n\r\n    GetAllStoneNode(){\r\n        return this.stoneNodeVec;\r\n    },\r\n\r\n    GetAllStoneGID(){\r\n        var allStoneGID = [];\r\n        for(var i = 0;i < this.stoneNodeVec.length; i ++){\r\n            var stone = this.stoneNodeVec[i];\r\n            allStoneGID.push(stone.gid);\r\n        }\r\n\r\n        return allStoneGID;\r\n    },\r\n\r\n    RemoveStoneByGID(gid){\r\n        for(var i = 0;i < this.stoneNodeVec.length;i ++){\r\n            var stone = this.stoneNodeVec[i];\r\n            if(stone && stone.gid == gid){\r\n                stone.destroy();\r\n                this.stoneNodeVec.splice(i, 1);\r\n            }\r\n        }\r\n    },\r\n\r\n    Clear(){\r\n        if(this.stoneNodeVec){\r\n            for(var i = 0;i < this.stoneNodeVec.length;i ++){\r\n                var stone = this.stoneNodeVec[i];\r\n                if(stone){\r\n                    stone.doExit();\r\n                }\r\n            }\r\n            this.stoneNodeVec.length = 0;\r\n        }\r\n\r\n        Game.EventCenter.RemoveEvent(this.uuid);\r\n    },\r\n\r\n    SetMyDropDirtyFlag(){\r\n        for(var i = 0;i < this.stoneNodeVec.length;i ++){\r\n            var stone = this.stoneNodeVec[i];\r\n            if(stone){\r\n                stone.setMyDropDirtyFlag(true);\r\n            }\r\n        }\r\n    },\r\n\r\n    FrameOnMove(dt){\r\n        for(var i = this.stoneNodeVec.length - 1;i >= 0;i --){\r\n            var stone = this.stoneNodeVec[i];\r\n            if(stone && stone.myDeleteDirtyFlag){\r\n                stone.RemoveStoneByGID(stone.gid);\r\n            }\r\n        }\r\n\r\n        for(var i = 0;i < this.stoneNodeVec.length;i ++){\r\n            var stone = this.stoneNodeVec[i];\r\n            if(stone){\r\n                stone.frameOnMove(dt);\r\n            }\r\n        }\r\n    },\r\n\r\n    onDestroy(){\r\n        cc.log(\"Stones-->onDestroy\");\r\n    }\r\n});\r\n\r\n"]}