{"version":3,"sources":["RankListScene.js"],"names":["Util","require","WXHelper","SceneCom","cc","Class","extends","properties","returnBtn","Node","rankingScrollView","Sprite","onLoad","self","tempTime","on","EventType","TOUCH_END","ranklistbtnClicked","ScreenAdaptation","node","tex","FetchFriendRankList","Game","SceneMgr","switchScene","SceneType","StartScene","_updateSubDomainCanvas","window","sharedCanvas","undefined","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","update","dt","GameConfig","FetchFriendRankListUpdateTime","onDestroy","log","ClearSharedCanvas"],"mappings":";;;;;;AAAA,IAAIA,OAAOC,QAAQ,MAAR,CAAX;AACA,IAAIC,WAAWD,QAAQ,UAAR,CAAf;AACA,IAAIE,WAAWF,QAAQ,UAAR,CAAf;;AAEAG,GAAGC,KAAH,CAAS;AACLC,aAASH,QADJ;;AAGLI,gBAAY;AACTC,mBAAWJ,GAAGK,IADL;AAETC,2BAAmBN,GAAGO,MAFb,CAEoB;AAFpB,KAHP;;AAQLC,UARK,oBAQG;AACJ,YAAIC,OAAO,IAAX;;AAEA,aAAKC,QAAL,GAAgB,CAAhB;;AAEA,aAAKN,SAAL,CAAeO,EAAf,CAAkBX,GAAGK,IAAH,CAAQO,SAAR,CAAkBC,SAApC,EAA+C,YAAU;AACrDJ,iBAAKK,kBAAL;AACH,SAFD;;AAIAlB,aAAKmB,gBAAL,CAAsB,KAAKT,iBAAL,CAAuBU,IAA7C;;AAEA,aAAKC,GAAL,GAAWnB,SAASoB,mBAAT,EAAX;AACH,KApBI;AAsBLJ,sBAtBK,gCAsBe;AAChBK,aAAKC,QAAL,CAAcC,WAAd,CAA0BF,KAAKG,SAAL,CAAeC,UAAzC;AACH,KAxBI;;;AA2BL;AACAC,0BA5BK,oCA4BoB;AACrB,YAAIC,OAAOC,YAAP,IAAuBC,SAAvB,IAAoC,KAAKV,GAA7C,EAAkD;AAC9C,iBAAKA,GAAL,CAASW,eAAT,CAAyBH,OAAOC,YAAhC;AACA,iBAAKT,GAAL,CAASY,mBAAT;AACA,iBAAKvB,iBAAL,CAAuBwB,WAAvB,GAAqC,IAAI9B,GAAG+B,WAAP,CAAmB,KAAKd,GAAxB,CAArC;AACH;AACJ,KAlCI;AAoCLe,UApCK,kBAoCGC,EApCH,EAoCO;AACR,aAAKvB,QAAL,IAAiBuB,EAAjB;;AAEA,YAAG,KAAKvB,QAAL,IAAiBwB,WAAWC,6BAA/B,EAA6D;AACzD,iBAAKzB,QAAL,GAAgB,CAAhB;AACA,iBAAKc,sBAAL;AACH;AACJ,KA3CI;AA6CLY,aA7CK,uBA6CM;AACPpC,WAAGqC,GAAH,CAAO,6BAAP;;AAEAvC,iBAASwC,iBAAT;;AAEA,aAAKhC,iBAAL,CAAuBwB,WAAvB,GAAqC,IAArC;AACH;AAnDI,CAAT","file":"RankListScene.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\scene","sourcesContent":["var Util = require(\"Util\");\r\nvar WXHelper = require(\"WXHelper\");\r\nvar SceneCom = require(\"SceneCom\");\r\n\r\ncc.Class({\r\n    extends: SceneCom,\r\n\r\n    properties: {\r\n       returnBtn: cc.Node,\r\n       rankingScrollView: cc.Sprite,//显示排行榜\r\n    },\r\n\r\n    onLoad(){\r\n        var self = this;\r\n\r\n        this.tempTime = 0;\r\n\r\n        this.returnBtn.on(cc.Node.EventType.TOUCH_END, function(){\r\n            self.ranklistbtnClicked();\r\n        });\r\n\r\n        Util.ScreenAdaptation(this.rankingScrollView.node);\r\n\r\n        this.tex = WXHelper.FetchFriendRankList();\r\n    },\r\n\r\n    ranklistbtnClicked(){\r\n        Game.SceneMgr.switchScene(Game.SceneType.StartScene);\r\n    },\r\n\r\n    \r\n    // 刷新子域的纹理\r\n    _updateSubDomainCanvas() {\r\n        if (window.sharedCanvas != undefined && this.tex) {\r\n            this.tex.initWithElement(window.sharedCanvas);\r\n            this.tex.handleLoadedTexture();\r\n            this.rankingScrollView.spriteFrame = new cc.SpriteFrame(this.tex);\r\n        }\r\n    },\r\n\r\n    update (dt) {\r\n        this.tempTime += dt;\r\n\r\n        if(this.tempTime >= GameConfig.FetchFriendRankListUpdateTime){\r\n            this.tempTime = 0;\r\n            this._updateSubDomainCanvas();\r\n        }\r\n    },\r\n\r\n    onDestroy(){\r\n        cc.log(\"RanklistScene-->>>onDestroy\");\r\n\r\n        WXHelper.ClearSharedCanvas();\r\n\r\n        this.rankingScrollView.spriteFrame = null;\r\n    }\r\n});\r\n"]}