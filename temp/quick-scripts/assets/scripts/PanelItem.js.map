{"version":3,"sources":["PanelItem.js"],"names":["cc","Class","extends","Component","properties","imgSp","displayName","default","type","Sprite","onLoad","setItemData","directInfo","createImage","img_url","node","tryCutGameName","name","newName","length","substring","getChildByName","getComponent","Label","string","onBtnClickItem","that","window","wx","undefined","navigateToMiniProgram","appId","app_id","path","extraData","gameId","game_id","envVersion","success","fail","res","avatarUrl","spNode","image","onload","texture","Texture2D","initWithElement","handleLoadedTexture","sp","SpriteFrame","spriteFrame","e","console","log","src","loader","load","url","err"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,eAAO,EAACC,aAAa,QAAd,EAAwBC,SAAS,IAAjC,EAAuCC,MAAMR,GAAGS,MAAhD;AADC,KAHP;;AAOLC,UAPK,oBAOI,CAER,CATI;AAWLC,eAXK,uBAWOC,UAXP,EAWmB;AACpB,aAAKA,UAAL,GAAkBA,UAAlB;AACA,aAAKC,WAAL,CAAiBD,WAAWE,OAA5B,EAAqC,KAAKT,KAAL,CAAWU,IAAhD;;AAEA,aAAKC,cAAL,CAAoBJ,WAAWK,IAA/B;AACH,KAhBI;AAkBLD,kBAlBK,0BAkBUC,IAlBV,EAkBgB;AACjB,YAAIC,UAAUD,IAAd;AACA,YAAGA,KAAKE,MAAL,GAAc,CAAjB,EAAoB;AAChBD,sBAAaD,KAAKG,SAAL,CAAe,CAAf,EAAmB,CAAnB,CAAb;AACH;AACD,aAAKL,IAAL,CAAUM,cAAV,CAAyB,MAAzB,EAAiCC,YAAjC,CAA8CtB,GAAGuB,KAAjD,EAAwDC,MAAxD,GAAiEN,OAAjE;AACH,KAxBI;;;AA0BL;AACAO,kBA3BK,4BA2BY;AACb,YAAIC,OAAO,IAAX;AACA,YAAIC,OAAOC,EAAP,IAAaC,SAAjB,EAA4B;AACxBD,eAAGE,qBAAH,CAAyB;AACrBC,uBAAOL,KAAKd,UAAL,CAAgBoB,MADF;AAErBC,sBAAMP,KAAKd,UAAL,CAAgBqB,IAFD;AAGrBC,2BAAW;AACPC,4BAAQT,KAAKd,UAAL,CAAgBwB;AADjB,iBAHU;AAMrBC,4BAAY,SANS;AAOrBC,uBAPqB,qBAOX;AACN;AACH,iBAToB;AAUrBC,oBAVqB,gBAUhBC,GAVgB,EAUX;AACN;AACH;AAZoB,aAAzB;AAcH;AACJ,KA7CI;AA+CL3B,eA/CK,uBA+CO4B,SA/CP,EA+CmBC,MA/CnB,EA+C2B;AAC5B,YAAGf,OAAOC,EAAP,IAAaC,SAAhB,EAA2B;AACvB,gBAAI;AACA,oBAAIc,QAAQf,GAAGf,WAAH,EAAZ;AACA8B,sBAAMC,MAAN,GAAe,YAAM;AACjB,wBAAI;AACA,4BAAIC,UAAU,IAAI7C,GAAG8C,SAAP,EAAd;AACAD,gCAAQE,eAAR,CAAwBJ,KAAxB;AACAE,gCAAQG,mBAAR;AACA,4BAAIC,KAAK,IAAIjD,GAAGkD,WAAP,CAAmBL,OAAnB,CAAT;AACAH,+BAAOpB,YAAP,CAAoBtB,GAAGS,MAAvB,EAA+B0C,WAA/B,GAA6CF,EAA7C;AACH,qBAND,CAMC,OAAMG,CAAN,EAAS;AACNC,gCAAQC,GAAR,CAAY,kBAAZ;AACH;AACJ,iBAVD;AAWAX,sBAAMY,GAAN,GAAYd,SAAZ;AACH,aAdD,CAcC,OAAMW,CAAN,EAAS;AACNC,wBAAQC,GAAR,CAAY,mBAAZ;AACH;AACJ,SAlBD,MAkBM;AACFtD,eAAGwD,MAAH,CAAUC,IAAV,CAAe;AACXC,qBAAKjB,SADM,EACKjC,MAAM;AADX,aAAf,EAEG,UAACmD,GAAD,EAAMd,OAAN,EAAkB;AACjB,oBAAII,KAAK,IAAIjD,GAAGkD,WAAP,CAAmBL,OAAnB,CAAT;AACAH,uBAAOpB,YAAP,CAAoBtB,GAAGS,MAAvB,EAA+B0C,WAA/B,GAA6CF,EAA7C;AACH,aALD;AAMH;AACJ;AA1EI,CAAT","file":"PanelItem.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        imgSp: {displayName: \"图表icon\", default: null, type: cc.Sprite},\r\n    },\r\n\r\n    onLoad() {\r\n\r\n    },\r\n\r\n    setItemData(directInfo) {\r\n        this.directInfo = directInfo;\r\n        this.createImage(directInfo.img_url, this.imgSp.node);\r\n\r\n        this.tryCutGameName(directInfo.name);\r\n    },\r\n\r\n    tryCutGameName(name) {\r\n        let newName = name;\r\n        if(name.length > 4) {\r\n            newName = `${name.substring(0 , 4)}...`;\r\n        }\r\n        this.node.getChildByName(\"name\").getComponent(cc.Label).string = newName;\r\n    },\r\n\r\n    //执行跳转逻辑\r\n    onBtnClickItem() {\r\n        let that = this;\r\n        if (window.wx != undefined) {\r\n            wx.navigateToMiniProgram({\r\n                appId: that.directInfo.app_id,\r\n                path: that.directInfo.path,\r\n                extraData: {\r\n                    gameId: that.directInfo.game_id\r\n                },\r\n                envVersion: 'release',\r\n                success() {\r\n                    //console.log(\"跳转成功\");\r\n                },\r\n                fail(res) {\r\n                    //console.log(\"跳转失败\", res);\r\n                },\r\n            })\r\n        }\r\n    },\r\n\r\n    createImage(avatarUrl , spNode) {\r\n        if(window.wx != undefined) {\r\n            try {\r\n                let image = wx.createImage();\r\n                image.onload = () => {\r\n                    try {\r\n                        let texture = new cc.Texture2D();\r\n                        texture.initWithElement(image);\r\n                        texture.handleLoadedTexture();\r\n                        let sp = new cc.SpriteFrame(texture);\r\n                        spNode.getComponent(cc.Sprite).spriteFrame = sp;\r\n                    }catch(e) {\r\n                        console.log(\"load image error\");\r\n                    }\r\n                }\r\n                image.src = avatarUrl;\r\n            }catch(e) {\r\n                console.log(\"createImage error\");\r\n            }\r\n        }else {\r\n            cc.loader.load({\r\n                url: avatarUrl, type: 'jpg'\r\n            }, (err, texture) => {\r\n                let sp = new cc.SpriteFrame(texture);\r\n                spNode.getComponent(cc.Sprite).spriteFrame = sp;\r\n            });\r\n        }\r\n    },\r\n});\r\n"]}